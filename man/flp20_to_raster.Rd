% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_burn_probability.R
\name{flp20_to_raster}
\alias{flp20_to_raster}
\title{Convert processed FLP data to raster format and calculate conditional annual burn probability}
\usage{
flp20_to_raster(df, fl_threshold, selected_surf, reference_surface, r_ref)
}
\arguments{
\item{df}{A data frame processed by `flp20_to_df` or `flp20_to_bp_df`,
containing `XPos`, `YPos`, `FL`, and `PBurn` (expected to be 1 for individual fires) columns.}

\item{fl_threshold}{A numeric value representing the minimum flame length (FL)
to include in the summary.}

\item{selected_surf}{A data frame or list containing a `size` column, used to
calculate the total selected surface.}

\item{reference_surface}{A numeric value representing a reference surface area,
used in the BP calculation.}

\item{r_ref}{A terra SpatRaster object that serves as the reference raster for
rasterization.}
}
\value{
A list containing two raster objects: `CBP` (Burning Probability),
   `CFL` (Mean Flame Length) and `ID_fires` (list of perimeter IDs).
}
\description{
Filters a data frame of fire data based on a flame length threshold,
groups by spatial position (`XPos`, `YPos`), and summarizes it into
conditional annual burning probability (CBP) estimates and
mean flame length (FL_mean). These summarized points are then rasterized
to a reference raster. `PBurn` is treated as a count of individual fires at a location.
}
\examples{
\dontrun{
# This example requires 'terra' and 'sf' packages.

# Create dummy data frame 'df_example' to simulate output from flp20_to_df
# Each row here represents an individual fire at a specific location, with its
# derived FL bin value. PBurn is 1.
df_example <- data.frame(
  XPos = c(10, 10, 20, 20, 30, 30),
  YPos = c(10, 10, 10, 20, 20, 10),
  PBurn = c(1, 1, 1, 1, 1, 1), # All individual fires, PBurn = 1
  # FL values derived from FIL bins (e.g., 0.25 for FIL1, 0.75 for FIL2, etc.)
  FL = c(0.25, 0.75, 0.25, 1.25, 0.75, 0.75)
)

# Create dummy 'selected_surf' data
selected_surf_example <- data.frame(size = c(1000, 2000, 500, 1500))

# Define a reference surface
reference_surface_example <- 10000

# Create a dummy SpatRaster for r_ref
# In a real scenario, this would be your actual reference raster.
# Make sure the extent covers the XPos, YPos range of dummy_df
r_ref_example <- terra::rast(
  nrows = 3, ncols = 3,
  xmin = 0, xmax = 40, ymin = 0, ymax = 30,
  crs = "EPSG:4326" # Example CRS
)

# Run the function with example data
raster_results <- fpl_to_raster(
  df = df_example,
  fl_threshold = 0.5, # Only include fires with FL >= 0.5 (e.g., FL 0.75 and 1.25)
  selected_surf = selected_surf_example,
  reference_surface = reference_surface_example,
  r_ref = r_ref_example
)

# Print and plot the results (optional)
print(raster_results$CBP)
plot(raster_results$CBP, main = "CBP Raster Example")
plot(raster_results$CFL, main = "CFL Raster Example")
}
}
